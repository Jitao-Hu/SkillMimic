# Configuration for HRL Dual Humanoid Pass-and-Catch Environment
# Based on skillmimic_dual.yaml with HRL-specific settings
#
# Usage:
#   python skillmimic/run.py --task HRLDualHumanoid \
#     --cfg_env skillmimic/data/cfg/hrl_dual_humanoid.yaml \
#     --cfg_train skillmimic/data/cfg/train/rlg/hrl_dual_humanoid.yaml \
#     --motion_file skillmimic/data/motions/BallPlay-M/pass \
#     --checkpoint skillmimic/data/models/mixedskills/nn/skillmimic_llc.pth \
#     --headless --num_envs 512

env: 
  numEnvs: 512  # Smaller for faster iteration during HRL training
  envSpacing: 4  # Increased spacing to accommodate two humanoids
  episodeLength: 0
  isFlagrun: False
  enableDebugVis: False
  playdataset: False
  projtype: "None"
  saveImages: ""
  initVel: False
  
  # Dual humanoid specific settings
  humanoidBSpacing: 3.0  # Distance between humanoid A and B on X axis (meters)
  
  pdControl: True
  powerScale: 1.0
  controlFrequencyInv: 1  # 60 Hz
  stateInit: "Random"
  hybridInitProb: 0.5
  dataFPS: 60
  dataFramesScale: 1.
  ballSize: 1.
  ballRestitution: 0.81
  ballDensity: 1000.

  localRootObs: False
  keyBodies: ["Head", "L_Knee", "R_Knee", "L_Elbow", "R_Elbow", "L_Ankle", "R_Ankle", 
              "L_Index3", "L_Middle3", "L_Pinky3", "L_Ring3", "L_Thumb3",
              "R_Index3", "R_Middle3", "R_Pinky3", "R_Ring3", "R_Thumb3"]
  keyBodiesWrist: ["Head", "L_Knee", "R_Knee", "L_Elbow", "R_Elbow", "L_Ankle", "R_Ankle"]
  contactBodies: ["L_Index3", "L_Middle3", "L_Pinky3", "L_Ring3", "L_Thumb3",
                  "R_Index3", "R_Middle3", "R_Pinky3", "R_Ring3", "R_Thumb3"]
  handBodies: ["L_Index3", "L_Middle3", "L_Pinky3", "L_Ring3", "L_Thumb3",
               "R_Index3", "R_Middle3", "R_Pinky3", "R_Ring3", "R_Thumb3"]
  terminationHeight: 0.25
  enableEarlyTermination: True  # Enabled for posture constraint enforcement

  asset:
    assetRoot: "skillmimic/data/assets"
    assetFileName: "mjcf/mocap_humanoid.xml"

  plane:
    staticFriction: 1.0
    dynamicFriction: 1.0
    restitution: 0.8

  # Original imitation reward weights (required by MotionDataHandler)
  rewardWeights:
    p: 20.
    r: 20.
    pv: 0.
    rv: 0.
    op: 1.
    or: 0.
    opv: 0.
    orv: 0.
    ig: 20.
    cg1: 5.
    cg2: 5.

  # Cooperative task reward weights
  coopRewardWeights:
    alive: 0.1
    ball_to_hand: 2.0
    pass_direction: 5.0         # Increased from 1.0 for better pass targeting
    catch_success: 10.0
    ball_height: 0.5
    standing: 2.0               # NEW: CoM height reward
    upright: 1.5                # NEW: Body verticality reward
    ground_contact_penalty: -5.0  # NEW: Penalty for non-foot ground contact

  # HRL-specific settings
  enableTaskObs: True
  goalSize: 5  # Size of task observations

sim:
  substeps: 2
  physx:
    num_threads: 4
    solver_type: 1
    num_position_iterations: 4
    num_velocity_iterations: 0
    contact_offset: 0.02
    rest_offset: 0.0
    bounce_threshold_velocity: 0.2
    max_depenetration_velocity: 10.0
    default_buffer_size_multiplier: 10.0

  flex:
    num_inner_iterations: 10
    warm_start: 0.25
